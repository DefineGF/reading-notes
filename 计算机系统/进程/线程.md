#### 线程

##### 引入目的

减少程序在并发执行时所付出的时空开销，是一个基本的CPU执行单元；



##### 组成

线程ID；程序计数器；寄存器集合；堆栈等；



##### 用户级线程

把整个线程包放在用户空间中，内核对线程一无所知；即用户线程可以在不支持线程的操作系统上实现；

应用程序可以通过线程库设计成多线程程序；

与进程区别：

- 线程完成时，先把线程信息（PC，堆栈指针寄存器，状态等）保存在线程表中（线程控制块），进而调用线程调度程序选择另一线程（本地）；无需陷入内核，不需要 上下文切换；
- 每个进程可独立定制自己的调度算法；
- 缺点：一个线程被阻塞，整个进程被阻塞；



##### 内核级线程

- 线程管理的所有工作由内核完成，内核为进程和内部的每个线程维护上下文信息，调度也是内核基于线程架构的基础上完成；

- 线程表保存了每个线程的寄存器、状态和其他信息在内核中；

- 当一个线程阻塞时，内核根据其选择，可以运行同一进程的另一个线程，也可以运行另一进程中的线程

- 不同进程调用的系统线程是相同的线程；



##### 多线程模型

- 多对一：多个用户线程 - 一个内核线程

  - 优点：线程管理是在用户空间进行的，效率较高；
  - 缺点：一个线程阻塞，整个进程都会被阻塞；

- 一对一：

  - 优点：并发能力较强；（一线程阻塞允许另一线程继续执行）
  - 缺点：开销较大（一个用户级线程 需创建 一个内核线程相对应）

  