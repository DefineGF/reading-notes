##### 缓冲池策略

- 全局策略：基于同一时间并发执行的查询
- 本地策略：基于每个查询；





#### 缓冲池优化

##### 多缓冲池

##### 缓存预取

##### 共享扫描

##### 绕过缓冲池



### 缓冲池

##### 页表

- 保存在内存中；
- 记录内存中的页在缓冲池中的偏移；
- 其他保存信息：
  - 脏位；
  - pin以及引用计数；
  - latch信息；

> 锁：与DBMS相关，加锁对象一般是整张表、某个页或者某个元组；出于对数据库逻辑抽象的保护，比如用于事务回滚等；
>
> latch：保护内部数据结构（类似于mutex）



##### 页目录

- 持久化在硬盘；
- 用于保存页id与硬盘页的映射；



##### LRU-K算法

访问页，如果缓冲池中存在相应页号，则直接获取，然后缓冲池中重新排序；

如果缓冲池中没有：

- 如果历史记录表中不存在：队尾添加对应的页号；记录当前访问时间，并设置访问次数为1；
- 如果历史表中存在：
  - 如果当前时间距上次访问时间超过一定间隔，则重新设为1；
  - 否则，访问次数加一，并更新访问时间，同时将其移到队尾；
    - 如果访问次数超过k，则将该页添加到缓冲池中；



